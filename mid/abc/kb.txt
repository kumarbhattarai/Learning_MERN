This is being called through middleware